<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
	"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
	"http://struts.apache.org/dtds/struts-2.3.dtd">

<struts>

    <constant name="struts.enable.DynamicMethodInvocation" value="true" />
    <constant name="struts.devMode" value="true" />

    <package name="default" namespace="/" extends="struts-default">
       <!--
        <default-action-ref name="index" />
 
        <global-results>
            <result name="error">error11.jsp</result>
        </global-results>

        <global-exception-mappings>
            <exception-mapping exception="java.lang.Exception" result="error"/>
        </global-exception-mappings>
         -->
         <!-- 通用Action -->
         <action name="common_*" class="com.song.struts.CommonAction" method="{1}">
             <!-- 加载URL -->
             <result name="loadUrl" type="chain">common_loadNavigation</result>
             <!-- 加载首页导航栏选项成功 -->
             <result name="ins" type="chain">index_loadArticle</result>
             <!-- 加载文章列表导航栏选项成功 -->
             <result name="ans" type="chain">
                 <param name="namespace">/article</param>
                 <param name="actionName">article_getList</param>
             </result>
             <!-- 加载单篇文章界面导航栏项成功 -->
             <result name="sns" type="chain">
                 <param name="namespace">/article</param>
                 <param name="actionName">article_showArticle</param>
             </result>
             <!-- 加载图片列表导航栏项成功 -->
             <result name="pns" type="chain">
                 <param name="namespace">/photo</param>
                 <param name="actionName">photo_getList</param>
             </result>
             <!-- 加载导航栏选项失败 -->
            <result name="loadNavFail" type="redirect">/error.jsp?info=加载导航栏数据失败</result> 
         </action>
         
		<!-- 登录 -->
        <action name="login" class="com.song.struts.LoginAction" method="login">
            <!-- 登录成功 -->
            <result name="loginSuccess" type="redirect">index_access?master=${user.username}&amp;type=100001</result>
            <!-- 登录失败 -->
            <result name="loginfail">/login.jsp</result>
        </action>
        <!-- 注册 -->
        <action name="register" class="com.song.struts.RegisterAction" method="register">
            <result name="register" type="redirect">index_access?master=${user.username}</result>
            <result name="registerfail">/error.jsp?info=注册失败</result>
        </action>
        <!-- 首页 -->
        <action name="index_*" class="com.song.struts.IndexAction" method="{1}">
            <!-- 跳转到加载URL信息的action -->
            <result name="access" type="chain">common_loadUrl</result>           
            <!-- 首页文章加载成功，显示首页内容 -->          
            <result name="articleSuccess">/view/main.jsp</result>
            <!-- 首页文章加载失败，显示首页内容 --> 
            <result name="articleFail">/error.jsp?info=加载文章失败</result>
        </action>

    </package>
    
    
    <package name="article" namespace="/article" extends="struts-default">
        <!-- 文章 -->
         <action name="article_*" class="com.song.struts.ArticleAction" method="{1}">
             <!-- <result name="showlist" type="chain">article_getList</result> -->
             <!-- 跳转到加载URL数据的action -->
             <result name="showList" type="chain">
                 <param name="namespace">/</param>
                 <param name="actionName">common_loadUrl</param>
             </result>
             <!-- 显示单篇文章成功 -->
             <result name="single" type="chain">
                 <param name="namespace">/</param>
                 <param name="actionName">common_loadUrl</param>
             </result>
            <!-- 获取文章列表成功 -->
            <result name="getListSuccess">/article/articlelist.jsp</result>
            <result name="write">/article/articleadd.jsp?master=${master}</result>
            <!-- 获取评论处理链 -->
            <result name="comment" type="chain">article_comment</result>
            <result name="singleShowSuccess">/article/articlesingle.jsp</result>
            <!-- 提交文章成功，跳转文件列表界面 -->
            <result name="addSuccess" type="redirectAction">
                <param name="actionName">article_showList?master=${master}&amp;page=1&amp;type=100002</param>
            </result>
            <result name="addfail">/error.jsp?info=文章发布失败</result>
            <result name="noarticle">/error.jsp?info=文章不存在</result>
        </action>
        
         <!-- 评论 -->
         <action name="comment_*" class="com.song.struts.CommentAction" method="{1}">
             <result name="commit" type="redirectAction">article_single?master=${master}&amp;articleID=${articleID}</result>
             <result name="commitfail">/error.jsp?info=提交评论失败</result>
         </action>
    </package>
    

    <package name="photo" namespace="/photo" extends="struts-default">
        <!-- 图片 -->
        <action name="photo_*" class="com.song.struts.PhotoAction" method="{1}">
            <!-- 显示图片列表处理链 -->
            <result name="showList">
                <param name="namespace">/</param>
                <param name="actionName">common_loadUrl</param>
            </result>
			<!-- 显示图片列表 -->
            <result name="getList">/picture/picturelist.jsp</result>
            <result name="add" type="chain">photo_showAdd</result>
            <result name="showadd">/picture/pictureadd.jsp</result>
        </action>
    </package>

    <!-- Add packages here -->

</struts>
