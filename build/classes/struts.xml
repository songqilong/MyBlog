<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
	"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
	"http://struts.apache.org/dtds/struts-2.3.dtd">

<struts>

    <constant name="struts.enable.DynamicMethodInvocation" value="true" />
    <constant name="struts.devMode" value="true" />

    <package name="default" namespace="/" extends="struts-default">
<!--
        <default-action-ref name="index" />
 
        <global-results>
            <result name="error">error11.jsp</result>
        </global-results>

        <global-exception-mappings>
            <exception-mapping exception="java.lang.Exception" result="error"/>
        </global-exception-mappings>
         -->
		<!-- 登录 -->
        <action name="login" class="com.song.struts.LoginAction" method="login">
            <result name="success" type="redirect">index_access?master=${user.username}</result>
            <result name="false">/login.jsp</result>
        </action>
        <!-- 注册 -->
        <action name="register" class="com.song.struts.RegisterAction" method="register">
            <result name="register" type="redirect">index_access?master=${user.username}</result>
            <result name="registerfail">/error.jsp?info=注册失败</result>
        </action>
        <!-- 首页 -->
        <action name="index_*" class="com.song.struts.IndexAction" method="{1}">
            <result name="access" type="chain">index_loadNav</result>
            <result name="nav" type="chain">index_loadArticle</result>
            <result name="navfail" type="redirect">/error.jsp?info=加载导航栏数据失败</result>           
            <result name="article">/view/main.jsp</result>
            <result name="articlefail">/error.jsp?info=加载文章失败</result>
        </action>

    </package>
    
    
    <package name="article" namespace="/article" extends="struts-default">
        <!-- 文章 -->
         <action name="article_*" class="com.song.struts.ArticleAction" method="{1}">
             <result name="showlist" type="chain">article_getList</result>
             <result name="showlistfail">/error.jsp?info=加载导航栏数据失败</result>
             <result name="showarticle" type="chain">article_showArticle</result>
            <result name="list">/article/articlelist.jsp</result>
            <result name="write">/article/articleadd.jsp?master=${master}</result>
            <result name="comment" type="chain">article_comment</result>
            <result name="single">/article/articlesingle.jsp</result>
            <result name="add" type="redirectAction">
                <param name="actionName">article_showList?master=${master}&amp;page=1</param>
            </result>
            <result name="addfail">/error.jsp?info=文章发布失败</result>
            <result name="noarticle">/error.jsp?info=文章不存在</result>
        </action>
        
         <!-- 评论 -->
         <action name="comment_*" class="com.song.struts.CommentAction" method="{1}">
             <result name="commit" type="redirectAction">article_single?master=${master}&amp;articleID=${articleID}</result>
             <result name="commitfail">/error.jsp?info=提交评论失败</result>
         </action>
    </package>
    

    <package name="photo" namespace="/photo" extends="struts-default">
        <!-- 图片 -->
        <action name="photo_*" class="com.song.struts.PhotoAction" method="{1}">
            <result name="showlist" type="chain">photo_getList</result>
            <result name="showlistfail">/error.jsp?info=加载导航栏数据失败</result>
            <result name="getlist">/picture/picturelist.jsp</result>
            <result name="add" type="chain">photo_showAdd</result>
            <result name="showadd">/picture/pictureadd.jsp</result>
        </action>
    </package>

    <!-- Add packages here -->

</struts>
